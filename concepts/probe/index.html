<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Probe - Cloudprober</title>
    <meta name="generator" content="Hugo 0.61.0" />

    
    <link rel="canonical" href="https://cloudprober.org/concepts/probe/">
    

    <meta property="og:url" content="https://cloudprober.org/concepts/probe/">
    <meta property="og:title" content="Cloudprober">
    
    <meta name="apple-mobile-web-app-title" content="Cloudprober">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://cloudprober.org/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://cloudprober.org/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://cloudprober.org/fonts/icon.eot');
        src: url('https://cloudprober.org/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://cloudprober.org/fonts/icon.woff')
               format('woff'),
             url('https://cloudprober.org/fonts/icon.ttf')
               format('truetype'),
             url('https://cloudprober.org/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/application.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/syntax.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://cloudprober.org/javascripts/modernizr.js"></script>

    

  </head>
  <body class=" ">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Probe
      </div>
    </div>

    

    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/google/cloudprober" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>Cloudprober </strong>
        
          <br>
          google/cloudprober
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/google/cloudprober/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/google/cloudprober/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Overview" href="https://cloudprober.org/">
	
	Overview
</a>



  
</li>



<li>
  
    



<a  title="Getting Started" href="https://cloudprober.org/getting-started/">
	
	Getting Started
</a>



  
</li>



<li>
  
    



<a class="current" title="What is a Probe" href="https://cloudprober.org/concepts/probe/">
	
	What is a Probe
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Targets Discovery" href="https://cloudprober.org/concepts/targets/">
	
	Targets Discovery
</a>



  
</li>



<li>
  
    <span class="section">How-Tos</span>
    <ul>
      
        
        



<a  title="Running On Kubernetes" href="https://cloudprober.org/how-to/run-on-kubernetes/">
	
	Running On Kubernetes
</a>



      
        
        



<a  title="External Probe" href="https://cloudprober.org/how-to/external-probe/">
	
	External Probe
</a>



      
        
        



<a  title="Validators" href="https://cloudprober.org/how-to/validators/">
	
	Validators
</a>



      
        
        



<a  title="Built-in Servers" href="https://cloudprober.org/how-to/built-in-servers/">
	
	Built-in Servers
</a>



      
        
        



<a  title="Extending Cloudprober" href="https://cloudprober.org/how-to/extensions/">
	
	Extending Cloudprober
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Probe </h1>

			<p>Cloudprober's main task is to run probes. A probe executes something, usually
against a set of targets, to verify that the systems are working as expected from consumers&rsquo; point of view. For example, an HTTP probe executes an HTTP request against a web server to verify that the web server is available. Cloudprober probes run repeatedly at a configured interval and export probe results as a set of metrics.</p>
<p>A probe is defined as a set of the following fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td>Probe type, for example: HTTP, PING or UDP</td>
</tr>
<tr>
<td><code>name</code></td>
<td>Probe name. Each probe should have a unique name.</td>
</tr>
<tr>
<td><code>interval_msec</code></td>
<td>How often to run the probe (in milliseconds).</td>
</tr>
<tr>
<td><code>timeout_msec</code></td>
<td>Probe timeout (in milliseconds).</td>
</tr>
<tr>
<td><code>targets</code></td>
<td>Targets to run probe against.</td>
</tr>
<tr>
<td><code>validator</code></td>
<td>Probe validators, further explained <a href="https://cloudprober.org/how-to/validators">here</a>.</td>
</tr>
<tr>
<td><code>&lt;type&gt;_probe</code></td>
<td>Probe type specific configuration.</td>
</tr>
</tbody>
</table>
<p>Please take a look at the <a href="https://github.com/google/cloudprober/blob/master/probes/proto/config.proto">ProbeDef protobuf</a> for further details on various fields and options. All probe types export following metrics at a minimum:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>total</code></td>
<td>Total number of probes.</td>
</tr>
<tr>
<td><code>success</code></td>
<td>Number of successful probes. Deficit between <em>total</em> and <em>success</em> indicates failures.</td>
</tr>
<tr>
<td><code>latency</code></td>
<td>Cumulative probe latency (by default in microseconds). Latency can also be configured to be a distribution (histogram) metric through a config option (<code>latency_distribution</code>). By default it's just the sum of the latencies observed so far. Average latency can be computed using <em>rate(latency) / rate(success)</em>.</td>
</tr>
</tbody>
</table>
<h2 id="probe-types">Probe Types</h2>
<p>Cloudprober has built-in support for the following probe types:</p>
<ul>
<li><a href="#ping">Ping</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#udp">UDP</a></li>
<li><a href="#dns">DNS</a></li>
<li><a href="#external">External</a></li>
</ul>
<p>More probe types can be added through cloudprober extensions (to be documented).</p>
<h3 id="ping">Ping</h3>
<p><a href="http://github.com/google/cloudprober/tree/master/probes/ping"><code>Code</code></a> | <a href="http://github.com/google/cloudprober/tree/master/probes/ping/proto/config.proto"><code>Config options</code></a></p>
<p>Ping probe type implements a fast ping prober, that can probe hundreds of
targets in parallel. Probe results are reported as number of packets sent
(total), received (success) and round-trip time (latency). It supports raw
sockets (requires root access) as well as datagram sockets for ICMP (doesn't
require root access).</p>
<p>ICMP datagram sockets are not enabled by default on most Linux systems. You can
enable them by running the following command:
<code>sudo sysctl -w net.ipv4.ping_group_range=&quot;0 5000&quot;</code></p>
<h3 id="http">HTTP</h3>
<p><a href="http://github.com/google/cloudprober/tree/master/probes/http"><code>Code</code></a> | <a href="http://github.com/google/cloudprober/tree/master/probes/http/proto/config.proto"><code>Config options</code></a></p>
<p>HTTP probe is be used to send HTTP(s) requests to a target and verify that a
response is received. Apart from the core probe metrics (total, success, and
latency), HTTP probes also export a map of response code counts. Requests are
marked as failed if there is a timeout.</p>
<h3 id="udp">UDP</h3>
<p><a href="http://github.com/google/cloudprober/tree/master/probes/udp"><code>Code</code></a> | <a href="http://github.com/google/cloudprober/tree/master/probes/udp/proto/config.proto"><code>Config options</code></a></p>
<p>UDP probe sends a UDP packet to the configured targets. UDP probe (and all
other probes that use ports) provides more coverage for the network elements on
the data path as most packet forwarding elements use 5-tuple hashing and using
a new source port for each probe ensures that we hit different network element
each time.</p>
<h3 id="dns">DNS</h3>
<p><a href="http://github.com/google/cloudprober/tree/master/probes/dns"><code>Code</code></a> | <a href="http://github.com/google/cloudprober/tree/master/probes/dns/proto/config.proto"><code>Config options</code></a></p>
<p>DNS probe type is implemented in a similar way as other probes except for that
it sends DNS requests to the target.</p>
<h3 id="external">External</h3>
<p><a href="http://github.com/google/cloudprober/tree/master/probes/external"><code>Code</code></a> | <a href="http://github.com/google/cloudprober/tree/master/probes/external/proto/config.proto"><code>Config options</code></a></p>
<p>External probe type allows running arbitrary probes through cloudprober. For an
external probe, actual probe logic resides in an external program; cloudprober
only manages the execution of that program and provides a way to export that
data through the standard channel.</p>
<p>External probe can be configured in two modes:</p>
<ul>
<li>
<p><strong>ONCE</strong>:
In this mode, an external program is executed for each probe run. Exit
status of the program determines the success or failure of the probe.
External probe can optionally be configured to interpret external program's
output as metrics. This is a simple model but it doesn't allow the external
program to maintain state and multiple forks can be expensive depending on
the frequency of the probes.</p>
</li>
<li>
<p><strong>SERVER</strong>:
In this mode, external program is expected to run in server mode. Cloudprober
automatically starts the external program if it's not running at the time of
the probe execution. Cloudprober and external probe process communicate with
each other over stdin/stdout using protobuf messages defined in
<a href="https://github.com/google/cloudprober/blob/master/probes/external/proto/server.proto">probes/external/proto/server.proto</a>.</p>
</li>
</ul>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				
			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/cloudprober.org\/';
      var repo_id  = 'google\/cloudprober';
    
    </script>

    <script src="https://cloudprober.org/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-79661-8', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>

