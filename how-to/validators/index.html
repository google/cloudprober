<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Validators - Cloudprober</title>
    <meta name="generator" content="Hugo 0.61.0" />

    
    <link rel="canonical" href="https://cloudprober.org/how-to/validators/">
    

    <meta property="og:url" content="https://cloudprober.org/how-to/validators/">
    <meta property="og:title" content="Cloudprober">
    
    <meta name="apple-mobile-web-app-title" content="Cloudprober">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://cloudprober.org/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://cloudprober.org/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://cloudprober.org/fonts/icon.eot');
        src: url('https://cloudprober.org/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://cloudprober.org/fonts/icon.woff')
               format('woff'),
             url('https://cloudprober.org/fonts/icon.ttf')
               format('truetype'),
             url('https://cloudprober.org/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/application.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://cloudprober.org/stylesheets/syntax.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://cloudprober.org/javascripts/modernizr.js"></script>

    

  </head>
  <body class=" ">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Validators
      </div>
    </div>

    

    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/google/cloudprober" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>Cloudprober </strong>
        
          <br>
          google/cloudprober
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/google/cloudprober/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/google/cloudprober/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Overview" href="https://cloudprober.org/">
	
	Overview
</a>



  
</li>



<li>
  
    



<a  title="Getting Started" href="https://cloudprober.org/getting-started/">
	
	Getting Started
</a>



  
</li>



<li>
  
    



<a  title="What is a Probe" href="https://cloudprober.org/concepts/probe/">
	
	What is a Probe
</a>



  
</li>



<li>
  
    



<a  title="Targets Discovery" href="https://cloudprober.org/concepts/targets/">
	
	Targets Discovery
</a>



  
</li>



<li>
  
    <span class="section">How-Tos</span>
    <ul>
      
        
        



<a  title="Running On Kubernetes" href="https://cloudprober.org/how-to/run-on-kubernetes/">
	
	Running On Kubernetes
</a>



      
        
        



<a  title="External Probe" href="https://cloudprober.org/how-to/external-probe/">
	
	External Probe
</a>



      
        
        



<a class="current" title="Validators" href="https://cloudprober.org/how-to/validators/">
	
	Validators
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Built-in Servers" href="https://cloudprober.org/how-to/built-in-servers/">
	
	Built-in Servers
</a>



      
        
        



<a  title="Extending Cloudprober" href="https://cloudprober.org/how-to/extensions/">
	
	Extending Cloudprober
</a>



      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Validators </h1>

			<p>Validators allow you to run checks on the probe request output (if any). For
example, you can specify if you expect the probe output to match a certain
regex or return a certain status code (for HTTP). You can configure more than
one validators and all validators should succeed for the probe to be marked as
success.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">probe <span class="o">{</span>
    name: <span class="s2">&#34;google_homepage&#34;</span>
    type: HTTP
    targets <span class="o">{</span>
        host_names: <span class="s2">&#34;www.google.com&#34;</span>
    <span class="o">}</span>
    interval_msec: <span class="m">10000</span>    <span class="c1"># Probe every 10s</span>

    <span class="c1"># This validator should succeed.</span>
    validator <span class="o">{</span>
        name: <span class="s2">&#34;status_code_2xx&#34;</span>
        http_validator <span class="o">{</span>
            success_status_codes: <span class="s2">&#34;200-299&#34;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1"># This validator will fail, notice missing &#39;o&#39; in our regex.</span>
    validator <span class="o">{</span>
        name: <span class="s2">&#34;gogle_re&#34;</span>
        regex: <span class="s2">&#34;gogle&#34;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>
<p>(Full listing: <a href="https://github.com/google/cloudprober/blob/master/examples/validators/cloudprober_validator.cfg">https://github.com/google/cloudprober/blob/master/examples/validators/cloudprober_validator.cfg</a>)</p>
<p>To make the debugging easier, validation failures are logged and exported as an
independent map counter &ndash; <em>validation_failure</em>, with <em>validator</em> key. For
example, the above example will result in the following counters being
exported after 5 runs:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">total<span class="o">{</span><span class="nv">probe</span><span class="o">=</span><span class="s2">&#34;google_homepage&#34;</span>,dst<span class="o">=</span><span class="s2">&#34;www.google.com&#34;</span><span class="o">}</span> <span class="m">5</span>
success<span class="o">{</span><span class="nv">probe</span><span class="o">=</span><span class="s2">&#34;google_homepage&#34;</span>,dst<span class="o">=</span><span class="s2">&#34;www.google.com&#34;</span><span class="o">}</span> <span class="m">0</span>
validation_failure<span class="o">{</span><span class="nv">validator</span><span class="o">=</span><span class="s2">&#34;status_code_2xx&#34;</span>,probe<span class="o">=</span><span class="s2">&#34;google_homepage&#34;</span>,dst<span class="o">=</span><span class="s2">&#34;www.google.com&#34;</span><span class="o">}</span> <span class="m">0</span>
validation_failure<span class="o">{</span><span class="nv">validator</span><span class="o">=</span><span class="s2">&#34;gogle_re&#34;</span>,probe<span class="o">=</span><span class="s2">&#34;google_homepage&#34;</span>,dst<span class="o">=</span><span class="s2">&#34;www.google.com&#34;</span><span class="o">}</span> <span class="m">5</span></code></pre></div>
<p>Note that validator counter will <strong>not</strong> go up if probe fails for other
reasons, for example web server timing out. That's why you typically don't want
to alert only on validation failures. That said, in some cases, validation
failures could be the only thing you're interested in, for example, if you're
trying to make sure that a certain copyright is always present in your web
pages or you want to catch data integrity issues in your network.</p>
<p>Let's take a look at the types of validators you can configure.</p>
<h2 id="regex-validator">Regex Validator</h2>
<p>Regex validator simply checks for a regex in the probe request output. It works
for all probe types except for UDP and UDP_LISTENER - these probe types don't
support any validators at the moment.</p>
<h2 id="http-validator">HTTP Validator</h2>
<p>HTTP response validator works only for the HTTP probe type. You can currently
use HTTP  validator to define success and failure status codes (represented by
success_status_codes and failure_stauts_codes in the config):</p>
<ul>
<li>If <em>failure_status_codes</em> is defined and response status code falls within
that range, validator is considered to have failed.</li>
<li>If <em>success_status_codes</em> is defined and response status code <em>does not</em>
fall within that range, validator is considered to have failed.</li>
</ul>
<p>We can possibly add more checks to HTTP validator in the future, for example to
verify headers.</p>
<h2 id="data-integrity-validator">Data Integrity Validator</h2>
<p>Data integrity validator is designed to catch the packet corruption issues in
the network. We have a basic check that verifies that the probe output is made
up purely of a pattern repeated many times over.</p>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				
			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/cloudprober.org\/';
      var repo_id  = 'google\/cloudprober';
    
    </script>

    <script src="https://cloudprober.org/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-79661-8', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>

